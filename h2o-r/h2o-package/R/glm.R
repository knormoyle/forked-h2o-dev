#' H2O Generalized Linear Models
#'
#' Fit a generalized linear model, specified by a response variable, a set of predictors, and a description of the error distribution.
#'
#' @param x
#' @param y
#' @param training_frame
#' @param ...
#' @param destination_key
#' @param validation_frame
#' @param score_each_iteration
#' @param do_classification
#' @param balance_classes
#' @param class_sampling_factors
#' @param max_after_balance_size
#' @param solver
#' @param standardize
#' @param family
#' @param link
#' @param tweedie_variance_power
#' @param tweedie_link_power
#' @param alpha
#' @param lambda
#' @param prior1
#' @param lambda_search
#' @param nlambdas
#' @param lambda_min_ratio
#' @param higher_accuracy
#' @param use_all_factor_levels
#' @param n_folds

h2o.glm <- function(x, y, training_frame, ...,
                    #AUTOGENERATED Params
                    destination_key,
                    validation_frame,
                    score_each_iteration,
                    do_classification,
                    balance_classes,
                    class_sampling_factors,
                    max_after_balance_size,
                    solver,
                    standardize,
                    family,
                    link,
                    tweedie_variance_power,
                    tweedie_link_power,
                    alpha,
                    lambda,
                    prior1,
                    lambda_search,
                    nlambdas,
                    lambda_min_ratio,
                    higher_accuracy,
                    use_all_factor_levels,
                    n_folds
                    )
{
    dots <- list(...)
  
    for(type in dots)
        if (is.environment(type))
        {
        dots$envir <- type
        type <- NULL
        }
    if (is.null(dots$envir)) 
        dots$envir <- parent.frame()

    if( missing(x) ) stop("`x` is missing, with no default")
    if( missing(y) ) stop("`y` is missing, with no default")
    if( missing(training_frame) ) stop("`training_frame` is missing, with no default")

    if (!inherits(training_frame, "H2OFrame"))
        tryCatch(training_frame <- h2o.getFrame(training_frame),
                 error = function(err) {
                   stop("argument \"training_frame\" must be a valid H2OFrame or key")
                })
#required map for params with different names, assuming it will change in the RESTAPI end
    .glm.map <- c("x" = "ignored_columns",
                "y" = "response_column",
                "key" = "destination_key")

    parms <- as.list(match.call(expand.dots = FALSE)[-1L])
    parms$... <- NULL

    args <- .verify_dataxy(training_frame, x, y)
    parms$x <- args$x_ignore
    parms$y <- args$y

    names(parms) <- lapply(names(parms), function(i) { if (i %in% names(.glm.map)) i <- .glm.map[[i]]; i })

    .h2o.createModel(training_frame@conn, 'glm', parms, dots$envir)
}
